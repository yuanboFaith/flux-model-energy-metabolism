sec.axis = sec_axis(trans = ~. / 10^6 * 22.4 * 1000 * 60 ,
breaks = seq(0, 180, 30),
name = "mL / h"))
plt.O2 <- (plt.O2 +
geom_segment(data = s <- d.infusion.stable.summary1 %>% ungroup() %>%
pairwise_t_test(O2.umol.min ~ phenotype, p.adjust.method = "bonferroni") %>%
func.sig1(y.max.up = 7, y.min.down = 7),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.O2
# load basic animal information from the ordinary infusion experiments
p <- c("db/db", "WT", "HFD", "ob/ob")
names(p) <- c("d", "L", "H", "O")
mypath = "/Users/boyuan/Desktop/Harvard/Research/db db mice/Infusion data/infusion rounds data.xlsx"
d.animal  <-  read_excel(path = mypath, sheet = "infusion rounds", skip = 7) %>%
mutate(phenotype = str_extract(mouse_ID, "[a-zA-Z]+")) %>%
mutate(phenotype = p[phenotype] %>% factor(levels = p) )
# plot body weight using the serum-labeling experiment infusion
d.BW2 <- d.animal %>% select(phenotype, mouse_ID, BW) %>%
group_by(mouse_ID, phenotype) %>%
summarise(BW = mean(BW)) %>%
filter(phenotype != "db/db")
plt.BW <- func.plt.basicsPhysiology(
mydata = d.BW2 %>% group_by(mouse_ID, phenotype) %>% summarise(BW = mean(BW)),
whichY = "BW", mytitle = "body weight") +
scale_y_continuous(breaks = seq(0, 80, 15),limits = c(0, NA),
name = "gram",
expand = expansion(mult = c(0, .1)))
plt.BW <- (plt.BW +
geom_segment(data = s <- d.BW2 %>% ungroup() %>%
pairwise_t_test(BW ~ phenotype, p.adjust.method = "bonferroni") %>%
add_xy_position(x = "phenotype") %>%
func.sig1(y.max.up = 4, y.min.down = 4, xmin.max.shift = -1),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.BW
# Glycemia (from the 13CO2 measurement experiments)
d.glycemia <- d.mouseID %>%
filter(phenotype %in% c("WT", "ob/ob", "HFD")) %>%
mutate(phenotype = factor(phenotype, levels = c("WT", "HFD", "ob/ob", "db/db"))) %>%
mutate(glycemia = as.numeric(`glycemia.mg/dL-basal`))
# group_by(phenotype, mouseID) %>%
# mutate(glycemia = mean(glycemia))
plt.glycemia <- d.glycemia %>%
func.plt.basicsPhysiology(whichY = "glycemia") +
scale_y_continuous(
breaks = seq(0, 600, 100), limits = c(0, NA),
name = "mg / dL", expand = expansion(mult = c(0, .1)),
sec.axis = sec_axis(trans = ~ . / 180 * 10, name = "mM"))
plt.glycemia <- (plt.glycemia +
geom_segment(data = s <- d.glycemia %>% ungroup() %>%
pairwise_t_test(glycemia ~ phenotype, p.adjust.method = "bonferroni") %>%
add_xy_position(x = "phenotype") %>%
func.sig1(),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.glycemia
# - total energy expenditure
d.energyExpenditure <- d.infusion.stable.summary1 %>%
mutate(O2.L.min = O2.umol.min / 10^6 * 22.4,
CO2.L.min = CO2.umol.min / 10^6 * 22.4) %>%
# energy expenditure using Weir's formula
mutate(kcal.h = (3.941 * O2.L.min + 1.106 * CO2.L.min) * 1440 / 24,
cal.min = kcal.h / 60 * 1000 )
plt.calorie <- d.energyExpenditure %>%
func.plt.basicsPhysiology(whichY = "cal.min", mytitle = "energy expenditure") +
scale_y_continuous(
name = "cal / min",
breaks = seq(0, 12, 3),
limits = c(0, NA),
expand = expansion(mult = c(0, .1)),
sec.axis = sec_axis(trans = ~. * 60 / 1000,
name = "kcal / h"))
plt.calorie <- (plt.calorie +
geom_segment(data = s <- d.energyExpenditure %>% ungroup() %>%
pairwise_t_test(cal.min ~ phenotype, p.adjust.method = "bonferroni") %>%
func.sig1(y.max.up = 1, y.min.down = 1),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.calorie
# plot all together
b <- ggplot() + theme_void()
p1 <- plot_grid(plt.BW , b, plt.glycemia , b, plt.CO2,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
p2 <- plot_grid(plt.O2 , b, plt.RER , b, plt.calorie,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
plot_grid(p1, p2, nrow = 2, align = "v")
# ANCOVA analysis
d.energyExpenditure %>% select(phenotype, mouseID)
# ANCOVA analysis
d.energyExpenditure %>% select(phenotype, mouseID)
d.energyExpenditure
d.energyExpenditure
# ANCOVA analysis
d.energyExpenditure %>% select(phenotype, mouseID, CO2.L)
d.energyExpenditure
# ANCOVA analysis
d.energyExpenditure %>% select(phenotype, mouseID, CO2.L.min)
d.energyExpenditure
# ANCOVA analysis
d.energyExpenditure %>% select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min)
# ANCOVA analysis
d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min)
# ANCOVA analysis
d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
# plot all together
b <- ggplot() + theme_void()
p1 <- plot_grid(plt.BW , b, plt.glycemia , b, plt.CO2,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
p2 <- plot_grid(plt.O2 , b, plt.RER , b, plt.calorie,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
plot_grid(p1, p2, nrow = 2, align = "v")
ggsave(filename = "basic physiology.pdf",
path = "/Users/boyuan/Desktop/Harvard/Manuscript/1. fluxomics/R Figures",
height = 8, width = 14)
# ANCOVA analysis
d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
View(d.energyExpenditure)
# ANCOVA analysis
d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
d.animal
d.animal %>% select(phenotype, mouse_ID, BW) %>%
group_by(mouse_ID, phenotype)
# plot body weight using the serum-labeling experiment infusion
d.BW2 <- d.animal %>% select(phenotype, mouse_ID, BW) %>%
group_by(mouse_ID, phenotype) %>%
summarise(BW = mean(BW)) %>%
filter(phenotype != "db/db")
View(d.BW2)
d.BW2
d.BW2 %>% select(phenotype, BW) %>% table()
d.BW2 %>% select(phenotype, mouse_ID) %>% table()
d.BW2
# plot body weight using the serum-labeling experiment infusion
d.BW2 <- d.animal %>% select(phenotype, mouse_ID, BW) %>%
group_by(mouse_ID, phenotype) %>%
summarise(BW = mean(BW)) %>%
filter(phenotype != "db/db")
plt.BW <- func.plt.basicsPhysiology(
mydata = d.BW2 %>% group_by(mouse_ID, phenotype) %>% summarise(BW = mean(BW)),
whichY = "BW", mytitle = "body weight") +
scale_y_continuous(breaks = seq(0, 80, 15),limits = c(0, NA),
name = "gram",
expand = expansion(mult = c(0, .1)))
plt.BW <- (plt.BW +
geom_segment(data = s <- d.BW2 %>% ungroup() %>%
pairwise_t_test(BW ~ phenotype, p.adjust.method = "bonferroni") %>%
add_xy_position(x = "phenotype") %>%
func.sig1(y.max.up = 4, y.min.down = 4, xmin.max.shift = -1),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.BW
# Glycemia (from the 13CO2 measurement experiments)
d.glycemia <- d.mouseID %>%
filter(phenotype %in% c("WT", "ob/ob", "HFD")) %>%
mutate(phenotype = factor(phenotype, levels = c("WT", "HFD", "ob/ob", "db/db"))) %>%
mutate(glycemia = as.numeric(`glycemia.mg/dL-basal`))
plt.glycemia <- d.glycemia %>%
func.plt.basicsPhysiology(whichY = "glycemia") +
scale_y_continuous(
breaks = seq(0, 600, 100), limits = c(0, NA),
name = "mg / dL", expand = expansion(mult = c(0, .1)),
sec.axis = sec_axis(trans = ~ . / 180 * 10, name = "mM"))
plt.glycemia <- (plt.glycemia +
geom_segment(data = s <- d.glycemia %>% ungroup() %>%
pairwise_t_test(glycemia ~ phenotype, p.adjust.method = "bonferroni") %>%
add_xy_position(x = "phenotype") %>%
func.sig1(),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.glycemia
# - total energy expenditure
d.energyExpenditure <- d.infusion.stable.summary1 %>%
mutate(O2.L.min = O2.umol.min / 10^6 * 22.4,
CO2.L.min = CO2.umol.min / 10^6 * 22.4) %>%
# energy expenditure using Weir's formula
mutate(kcal.h = (3.941 * O2.L.min + 1.106 * CO2.L.min) * 1440 / 24,
cal.min = kcal.h / 60 * 1000 )
plt.calorie <- d.energyExpenditure %>%
func.plt.basicsPhysiology(whichY = "cal.min", mytitle = "energy expenditure") +
scale_y_continuous(
name = "cal / min",
breaks = seq(0, 12, 3),
limits = c(0, NA),
expand = expansion(mult = c(0, .1)),
sec.axis = sec_axis(trans = ~. * 60 / 1000,
name = "kcal / h"))
plt.calorie <- (plt.calorie +
geom_segment(data = s <- d.energyExpenditure %>% ungroup() %>%
pairwise_t_test(cal.min ~ phenotype, p.adjust.method = "bonferroni") %>%
func.sig1(y.max.up = 1, y.min.down = 1),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.calorie
# plot all together
b <- ggplot() + theme_void()
p1 <- plot_grid(plt.BW , b, plt.glycemia , b, plt.CO2,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
p2 <- plot_grid(plt.O2 , b, plt.RER , b, plt.calorie,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
# ANCOVA analysis
d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
d.energyExpenditure
# ANCOVA analysis
d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
# ANCOVA analysis
d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
d.energyExpenditure.selected
d.energyExpenditure.selected
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point()
d.energyExpenditure.selected
d.energyExpenditure.selected %>% select(-BW)
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.energyExpenditure.selected
d.energyExpenditure.selected %>% select(mouseID, BW)
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.energyExpenditure.selected %>% select(mouseID, BW), by = "mouseID")
d.energyExpenditure.selected %>% select(mouseID, BW), by = "mouseID"
d.energyExpenditure.selected %>% select(mouseID, BW)
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.energyExpenditure.selected %>% select(mouseID, BW, phenotype))
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.energyExpenditure.selected %>% select(mouseID, BW, phenotype)
d.energyExpenditure.selected %>% select(mouseID, BW, phenotype) %>% complete.cases()
d.BW.respirometry <- d.energyExpenditure.selected %>% select(mouseID, BW, phenotype)
complete.cases(d.BW.respirometry)
d.BW.respirometry[complete.cases(d.BW.respirometry), ]
d.BW.respirometry <- d.BW.respirometry[complete.cases(d.BW.respirometry), ]
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.BW.respirometry)
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.BW.respirometry
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.BW.respirometry)
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.BW.respirometry
View(d.BW.respirometry)
d.energyExpenditure.selected
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
d.BW.respirometry <- d.energyExpenditure.selected %>% select(mouseID, BW, phenotype)
d.BW.respirometry <- d.BW.respirometry[complete.cases(d.BW.respirometry), ]
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.BW.respirometry)
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.BW.respirometry, by = c("phenotype", "mouseID"))
d.energyExpenditure.selected
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
inner_join(d.BW.respirometry, by = c("phenotype", "mouseID"))
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index")
d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.BW.respirometry, by = c("phenotype", "mouseID"))
x <- d.energyExpenditure.selected %>% select(-BW) %>%
pivot_longer(-c(phenotype, mouseID), values_to = "value", names_to = "index") %>%
left_join(d.BW.respirometry, by = c("phenotype", "mouseID"))
x[complete.cases(x), ]
x <- x[complete.cases(x), ]
x %>% ggplot(aes(BW, value, colo = phenotype)) + geom_point() +
facet_wrap(~index)
x %>% ggplot(aes(BW, value, colo = phenotype)) + geom_point() +
facet_wrap(~index, scales = "free")
x %>% ggplot(aes(BW, value, color = phenotype)) + geom_point() +
facet_wrap(~index, scales = "free")
x %>% ggplot(aes(BW, value, color = phenotype)) + geom_point() +
facet_wrap(~index, scales = "free") +
geom_smooth(method = "lm", se = F)
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point()
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW) +
geom_smooth(method = "lm", se = F)
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW)
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point() +
geom_smooth(method = "lm", se = F)
d.energyExpenditure.selected
glm(O2.L.min ~ BW + phenotype + BW:phenotype, data = d.energyExpenditure.selected)
model.glm <- glm(O2.L.min ~ BW + phenotype + BW:phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summarise(model.glm)
model.glm <- glm(O2.L.min ~ BW + phenotype + BW:phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summarise(model.glm)
summary(model.glm)
model.glm <- glm(O2.L.min ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
summary(model.glm)
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW, RER)
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point() +
geom_smooth(method = "lm", se = F)
model.glm <- glm(RER ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
model.glm <- glm(RER ~ phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
model.glm <- glm(O2.L.min ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
model.glm <- glm(CO2.L.min ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
# ANCOVA test
model.glm <- glm(CO2.L.min ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
func.plt.basicsPhysiology(whichY = "BW", mytitle = "O2 consumption")
func.plt.basicsPhysiology(whichY = "BW", mytitle = "BW")
func.plt.basicsPhysiology(whichY = "BW", mytitle = "BW")
# load basic animal information from the ordinary infusion experiments
p <- c("db/db", "WT", "HFD", "ob/ob")
names(p) <- c("d", "L", "H", "O")
mypath = "/Users/boyuan/Desktop/Harvard/Research/db db mice/Infusion data/infusion rounds data.xlsx"
d.animal  <-  read_excel(path = mypath, sheet = "infusion rounds", skip = 7) %>%
mutate(phenotype = str_extract(mouse_ID, "[a-zA-Z]+")) %>%
mutate(phenotype = p[phenotype] %>% factor(levels = p) )
# plot body weight using the serum-labeling experiment infusion
d.BW2 <- d.animal %>% select(phenotype, mouse_ID, BW) %>%
group_by(mouse_ID, phenotype) %>%
summarise(BW = mean(BW)) %>%
filter(phenotype != "db/db")
plt.BW <- func.plt.basicsPhysiology(
mydata = d.BW2 %>% group_by(mouse_ID, phenotype) %>% summarise(BW = mean(BW)),
whichY = "BW", mytitle = "body weight") +
scale_y_continuous(breaks = seq(0, 80, 15),limits = c(0, NA),
name = "gram",
expand = expansion(mult = c(0, .1)))
plt.BW <- (plt.BW +
geom_segment(data = s <- d.BW2 %>% ungroup() %>%
pairwise_t_test(BW ~ phenotype, p.adjust.method = "bonferroni") %>%
add_xy_position(x = "phenotype") %>%
func.sig1(y.max.up = 4, y.min.down = 4, xmin.max.shift = -1),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.BW
# Glycemia (from the 13CO2 measurement experiments)
d.glycemia <- d.mouseID %>%
filter(phenotype %in% c("WT", "ob/ob", "HFD")) %>%
mutate(phenotype = factor(phenotype, levels = c("WT", "HFD", "ob/ob", "db/db"))) %>%
mutate(glycemia = as.numeric(`glycemia.mg/dL-basal`))
plt.glycemia <- d.glycemia %>%
func.plt.basicsPhysiology(whichY = "glycemia") +
scale_y_continuous(
breaks = seq(0, 600, 100), limits = c(0, NA),
name = "mg / dL", expand = expansion(mult = c(0, .1)),
sec.axis = sec_axis(trans = ~ . / 180 * 10, name = "mM"))
plt.glycemia <- (plt.glycemia +
geom_segment(data = s <- d.glycemia %>% ungroup() %>%
pairwise_t_test(glycemia ~ phenotype, p.adjust.method = "bonferroni") %>%
add_xy_position(x = "phenotype") %>%
func.sig1(),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.glycemia
# - total energy expenditure
d.energyExpenditure <- d.infusion.stable.summary1 %>%
mutate(O2.L.min = O2.umol.min / 10^6 * 22.4,
CO2.L.min = CO2.umol.min / 10^6 * 22.4) %>%
# energy expenditure using Weir's formula
mutate(kcal.h = (3.941 * O2.L.min + 1.106 * CO2.L.min) * 1440 / 24,
cal.min = kcal.h / 60 * 1000 )
plt.calorie <- d.energyExpenditure %>%
func.plt.basicsPhysiology(whichY = "cal.min", mytitle = "energy expenditure") +
scale_y_continuous(
name = "cal / min",
breaks = seq(0, 12, 3),
limits = c(0, NA),
expand = expansion(mult = c(0, .1)),
sec.axis = sec_axis(trans = ~. * 60 / 1000,
name = "kcal / h"))
plt.calorie <- (plt.calorie +
geom_segment(data = s <- d.energyExpenditure %>% ungroup() %>%
pairwise_t_test(cal.min ~ phenotype, p.adjust.method = "bonferroni") %>%
func.sig1(y.max.up = 1, y.min.down = 1),
aes(x = xmin, xend = xmax, y = y.position, yend = y.position), inherit.aes = F))  %>%
func.sig2()
plt.calorie
# plot all together
b <- ggplot() + theme_void()
p1 <- plot_grid(plt.BW , b, plt.glycemia , b, plt.CO2,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
p2 <- plot_grid(plt.O2 , b, plt.RER , b, plt.calorie,
nrow = 1, rel_widths = c(1, .1, 1, .1, 1))
plot_grid(p1, p2, nrow = 2, align = "v")
ggsave(filename = "basic physiology.pdf",
path = "/Users/boyuan/Desktop/Harvard/Manuscript/1. fluxomics/R Figures",
height = 8, width = 14)
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW, RER)
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point() +
geom_smooth(method = "lm", se = F)
# ANCOVA test
model.glm <- glm(CO2.L.min ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW, RER) +
theme_bw()
# ANCOVA analysis
d.energyExpenditure.selected <- d.energyExpenditure %>% ungroup() %>%
select(phenotype, mouseID, CO2.L.min, O2.L.min, cal.min, BW, RER) +
theme.myClassic
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point() +
geom_smooth(method = "lm", se = F) +
theme.mybw
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point() +
geom_smooth(method = "lm", se = F) +
theme_classic()
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) + geom_point() +
geom_smooth(method = "lm", se = F) +
theme.myClassic
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) +
geom_point(size = 3, alpha = .6) +
geom_smooth(method = "lm", se = F) +
theme.myClassic
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) +
geom_point(size = 3, alpha = .5) +
geom_smooth(method = "lm", se = F) +
theme.myClassic
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) +
geom_point(size = 3, alpha = .5) +
geom_smooth(method = "lm", se = F) +
theme.myClassic +
scale_color_manual(values = color.phenotype)
# ANCOVA test
model.glm <- glm(CO2.L.min ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
# plot
d.energyExpenditure.selected %>%
ggplot(aes(BW, CO2.L.min, color = phenotype)) +
geom_point(size = 3, alpha = .5) +
geom_smooth(method = "lm", se = F) +
theme.myClassic +
scale_color_manual(values = color.phenotype)
ggsave(filename = "BW_energy_expenditure_ANCOVA.pdf",
path = "/Users/boyuan/Desktop/Harvard/Manuscript/1. fluxomics/R Figures",
height = 6, width = 6)
ggsave(filename = "BW_energy_expenditure_ANCOVA.pdf",
path = "/Users/boyuan/Desktop/Harvard/Manuscript/1. fluxomics/R Figures",
height = 4, width = 5)
# ANCOVA test
model.glm <- glm(CO2.L.min ~ BW + phenotype,
data = d.energyExpenditure.selected,
family = gaussian(link = "identity"))
summary(model.glm)
